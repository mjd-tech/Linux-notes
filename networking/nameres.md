# Name Resolution

Converts a network name (myhost.example.com) to an IP address.

- DNS - Domain Name System - servers with database of host/IP address
  pairs and other records such as mail exchange, alias, etc.
- Hosts file - local file - host/IP address pairs only
- Zero Config - Linux (avahi) Apple (bonjour) automatic DNS using the
  .local domain and multicast IP transmission (mDNS)

The file `/etc/nsswitch.conf` controls the order of name resolution and
is typically
```
# Ubuntu
hosts: files mdns4_minimal [NOTFOUND=return] dns mymachines
# Manjaro
hosts: mymachines mdns_minimal [NOTFOUND=return] resolve [!UNAVAIL=return] files myhostname dns
```
Note: In Manjaro, I changed "mdns_minimal" to "mdns4_minimal" and put "files" immediately
before "mdns4_minimal"

## DNS

DNS is configured in `/etc/resolv.conf`

### Ubuntu

Uses systemd-resolved. This runs a DNS server on localhost. It is a DNS cache.
`etc/resolv.conf` is a symlink to `/run/systemd/resolve/stub-resolv.conf`

```
# This is /run/systemd/resolve/stub-resolv.conf managed by man:systemd-resolved(8).
# Do not edit.
#
# This file might be symlinked as /etc/resolv.conf. If you're looking at
# /etc/resolv.conf and seeing this text, you have followed the symlink.
#
# ...
nameserver 127.0.0.53
options edns0 trust-ad
search foo.bar.yourisp.net
```

```
# Confirm we are we running systemd-resolved
systemctl is-active systemd-resolved

# Get some info
resolvectl statistics

# List the external DNS servers in use
resolvectl dns
```

### Manjaro

Does NOT use a DNS cache. NetworkManager directly writes to `etc/resolv.conf` which is a regular file,
not a symlink.

```
# Generated by NetworkManager
search foo.bar.yourisp.net
nameserver IP4_ADDRESS_HERE
nameserver IP4_ADDRESS_HERE
nameserver IP6_ADDRESS_HERE
# NOTE: the libc resolver may not support more than 3 nameservers.
# The nameservers listed below may not be recognized.
nameserver IP6_ADDRESS_HERE
```
## Hosts file

Any entries in the hosts file will override DNS. This is useful for
things like testing websites locally. Also commonly used to assign the
loopback address 127.0.0.1 to annoying adware/spy/phone-home sites.

    10.1.10.1  myrouter  # Lan port for Netgear router
